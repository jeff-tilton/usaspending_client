<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1" />
<meta name="generator" content="pdoc 0.9.2" />
<title>usaspending_client.client API documentation</title>
<meta name="description" content="" />
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/11.0.1/sanitize.min.css" integrity="sha256-PK9q560IAAa6WVRRh76LtCaI8pjTJ2z11v0miyNNjrs=" crossorigin>
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/11.0.1/typography.min.css" integrity="sha256-7l/o7C8jubJiy74VsKTidCy1yBkRtiUGbVkYBylBqUg=" crossorigin>
<link rel="stylesheet preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/styles/github.min.css" crossorigin>
<style>:root{--highlight-color:#fe9}.flex{display:flex !important}body{line-height:1.5em}#content{padding:20px}#sidebar{padding:30px;overflow:hidden}#sidebar > *:last-child{margin-bottom:2cm}.http-server-breadcrumbs{font-size:130%;margin:0 0 15px 0}#footer{font-size:.75em;padding:5px 30px;border-top:1px solid #ddd;text-align:right}#footer p{margin:0 0 0 1em;display:inline-block}#footer p:last-child{margin-right:30px}h1,h2,h3,h4,h5{font-weight:300}h1{font-size:2.5em;line-height:1.1em}h2{font-size:1.75em;margin:1em 0 .50em 0}h3{font-size:1.4em;margin:25px 0 10px 0}h4{margin:0;font-size:105%}h1:target,h2:target,h3:target,h4:target,h5:target,h6:target{background:var(--highlight-color);padding:.2em 0}a{color:#058;text-decoration:none;transition:color .3s ease-in-out}a:hover{color:#e82}.title code{font-weight:bold}h2[id^="header-"]{margin-top:2em}.ident{color:#900}pre code{background:#f8f8f8;font-size:.8em;line-height:1.4em}code{background:#f2f2f1;padding:1px 4px;overflow-wrap:break-word}h1 code{background:transparent}pre{background:#f8f8f8;border:0;border-top:1px solid #ccc;border-bottom:1px solid #ccc;margin:1em 0;padding:1ex}#http-server-module-list{display:flex;flex-flow:column}#http-server-module-list div{display:flex}#http-server-module-list dt{min-width:10%}#http-server-module-list p{margin-top:0}.toc ul,#index{list-style-type:none;margin:0;padding:0}#index code{background:transparent}#index h3{border-bottom:1px solid #ddd}#index ul{padding:0}#index h4{margin-top:.6em;font-weight:bold}@media (min-width:200ex){#index .two-column{column-count:2}}@media (min-width:300ex){#index .two-column{column-count:3}}dl{margin-bottom:2em}dl dl:last-child{margin-bottom:4em}dd{margin:0 0 1em 3em}#header-classes + dl > dd{margin-bottom:3em}dd dd{margin-left:2em}dd p{margin:10px 0}.name{background:#eee;font-weight:bold;font-size:.85em;padding:5px 10px;display:inline-block;min-width:40%}.name:hover{background:#e0e0e0}dt:target .name{background:var(--highlight-color)}.name > span:first-child{white-space:nowrap}.name.class > span:nth-child(2){margin-left:.4em}.inherited{color:#999;border-left:5px solid #eee;padding-left:1em}.inheritance em{font-style:normal;font-weight:bold}.desc h2{font-weight:400;font-size:1.25em}.desc h3{font-size:1em}.desc dt code{background:inherit}.source summary,.git-link-div{color:#666;text-align:right;font-weight:400;font-size:.8em;text-transform:uppercase}.source summary > *{white-space:nowrap;cursor:pointer}.git-link{color:inherit;margin-left:1em}.source pre{max-height:500px;overflow:auto;margin:0}.source pre code{font-size:12px;overflow:visible}.hlist{list-style:none}.hlist li{display:inline}.hlist li:after{content:',\2002'}.hlist li:last-child:after{content:none}.hlist .hlist{display:inline;padding-left:1em}img{max-width:100%}td{padding:0 .5em}.admonition{padding:.1em .5em;margin-bottom:1em}.admonition-title{font-weight:bold}.admonition.note,.admonition.info,.admonition.important{background:#aef}.admonition.todo,.admonition.versionadded,.admonition.tip,.admonition.hint{background:#dfd}.admonition.warning,.admonition.versionchanged,.admonition.deprecated{background:#fd4}.admonition.error,.admonition.danger,.admonition.caution{background:lightpink}</style>
<style media="screen and (min-width: 700px)">@media screen and (min-width:700px){#sidebar{width:30%;height:100vh;overflow:auto;position:sticky;top:0}#content{width:70%;max-width:100ch;padding:3em 4em;border-left:1px solid #ddd}pre code{font-size:1em}.item .name{font-size:1em}main{display:flex;flex-direction:row-reverse;justify-content:flex-end}.toc ul ul,#index ul{padding-left:1.5em}.toc > ul > li{margin-top:.5em}}</style>
<style media="print">@media print{#sidebar h1{page-break-before:always}.source{display:none}}@media print{*{background:transparent !important;color:#000 !important;box-shadow:none !important;text-shadow:none !important}a[href]:after{content:" (" attr(href) ")";font-size:90%}a[href][title]:after{content:none}abbr[title]:after{content:" (" attr(title) ")"}.ir a:after,a[href^="javascript:"]:after,a[href^="#"]:after{content:""}pre,blockquote{border:1px solid #999;page-break-inside:avoid}thead{display:table-header-group}tr,img{page-break-inside:avoid}img{max-width:100% !important}@page{margin:0.5cm}p,h2,h3{orphans:3;widows:3}h1,h2,h3,h4,h5,h6{page-break-after:avoid}}</style>
<script defer src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/highlight.min.js" integrity="sha256-Uv3H6lx7dJmRfRvH8TH6kJD1TSK1aFcwgx+mdg3epi8=" crossorigin></script>
<script>window.addEventListener('DOMContentLoaded', () => hljs.initHighlighting())</script>
</head>
<body>
<main>
<article id="content">
<header>
<h1 class="title">Module <code>usaspending_client.client</code></h1>
</header>
<section id="section-intro">
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">import logging
import sys
import json

from io import BytesIO
from urllib.request import urlretrieve
from urllib.request import urlopen
import shutil
import requests
import pandas as pd
from zipfile import ZipFile

from .utils import log_decorator


LOGGER = logging.getLogger(__name__)
LD = log_decorator(LOGGER)
FORMAT = &#34;%(levelname)s - %(asctime)s - %(name)s - %(message)s&#34;


class USASpending:
    def __init__(self, verbosity=10):
        self.BASE_URL = &#34;https://api.usaspending.gov&#34;
        logging.basicConfig(stream=sys.stderr, level=verbosity, format=FORMAT)

    @LD
    def bulk_download_awards(
        self,
        start_date=None,
        end_date=None,
        date_type=&#34;action_date&#34;,
        agencies=[{&#34;toptier_name&#34;: &#34;Department of Energy&#34;}],
        prime_award_types=[],
        place_of_performance_locations=[],
        place_of_performance_scope=None,
        recipient_locations=None,
        recipient_scope=None,
        sub_award_types=None,
        filters=None,
    ):
        &#34;&#34;&#34;This method sends a request to the backend to begin generating a
            zipfile of award data in CSV form for download.  [Full documentation for endpoint](https://github.com/fedspendingtransparency/usaspending-api/blob/master/usaspending_api/api_contracts/contracts/v2/bulk_download/awards.md).

        Parameters
        ----------
        start_date : str
            Required start date of time period.
        end_date : str
            Required end date of time period.
        date_type : enum[str]
            - `&#39;domestic&#39;`
            - `&#39;foreign&#39;`
        agencies : array[Agency]


        prime_award_types : array[enum[string]]

            - `&#39;IDV_A&#39;`
            - `&#39;IDV_B&#39;`
            - `&#39;IDV_B_A&#39;`
            - `&#39;IDV_B_B&#39;`
            - `&#39;IDV_B_C&#39;`
            - `&#39;IDV_C&#39;`
            - `&#39;IDV_D&#39;`
            - `&#39;IDV_E&#39;`
            - `&#39;02&#39;`
            - `&#39;03&#39;`
            - `&#39;04&#39;`
            - `&#39;05&#39;`
            - `&#39;06&#39;`
            - `&#39;07&#39;`
            - `&#39;08&#39;`
            - `&#39;09&#39;`
            - `&#39;10&#39;`
            - `&#39;11&#39;`
            - `&#39;A&#39;`
            - `&#39;B&#39;`
            - `&#39;C&#39;`
            - `&#39;D&#39;`

        place_of_performance_locations : array[Location]

        place_of_performance_scope : enum[string]

            - `&#39;domestic&#39;`
            - `&#39;foreign&#39;`



        recipient_locations : array[Location]

        recipient_scope : enum[string]

            - `&#39;domestic&#39;`
            - `&#39;foreign&#39;`


        sub_award_types : array[enum[string]]

            - `&#39;grant`&#39;
            - `&#39;procurement&#39;`

        filters : object
            A fully built python dictionary with all filters, bypassing all other arguments.
            See [endpoint documentation](https://github.com/fedspendingtransparency/usaspending-api/blob/master/usaspending_api/api_contracts/contracts/v2/bulk_download/awards.md) for an example.


        ## Agency: object

        - name: str
        - tier: enum[str]

            -- `&#39;toptier&#39;`

            -- `&#39;subtier&#39;`

        - type: enum[str]

            -- `&#39;funding&#39;`

            -- `&#39;awarding`&#39;

        ## Location: object

        - `&#39;country`&#39;: str
        - `&#39;state`&#39;: str
        - `&#39;county`&#39;: str
        - `&#39;city`&#39;: str
        - `&#39;district`&#39;: str
        - `&#39;zip`&#39;: str

        Returns
        -------
        request.response
            Response from the USASpending /api/v2/bulk_download/awards/ endpoint.

        Examples
        -------

        ```python
        &gt;&gt;&gt; #using arguments
        &gt;&gt;&gt; from usaspending_client import USASpending
        &gt;&gt;&gt; usa = USASpending()
        &gt;&gt;&gt; response = usa.bulk_download_awards(start_date=&#34;2019-10-01&#34;, end_date=&#34;2020-09-30&#34;, prime_award_types=[&#34;A&#34;])
        &gt;&gt;&gt; #using filters object
        &gt;&gt;&gt; filters = {&#34;prime_award_types&#34;: [&#34;A&#34;],&#34;sub_award_types&#34;: [],&#34;date_type&#34;: &#34;action_date&#34;,&#34;date_range&#34;: {&#34;start_date&#34;: &#34;2019-10-01&#34;,&#34;end_date&#34;: &#34;2020-09-30&#34;},&#34;agencies&#34;: [{&#34;type&#34;: &#34;funding&#34;,&#34;tier&#34;: &#34;subtier&#34;,&#34;name&#34;: &#34;Animal and Plant Health Inspection Service&#34;,&#34;toptier_name&#34;: &#34;Department of Agriculture&#34;}]}
        &gt;&gt;&gt; response = usa.bulk_download_awards(filters=filters)
        ```
        &#34;&#34;&#34;
        url = self.BASE_URL + &#34;/api/v2/bulk_download/awards/&#34;

        if not filters:
            start_date = pd.to_datetime(start_date).strftime(&#34;%Y-%m-%d&#34;)
            end_date = pd.to_datetime(end_date).strftime(&#34;%Y-%m-%d&#34;)
            date_range = {&#34;start_date&#34;: start_date, &#34;end_date&#34;: end_date}
            kwargs = locals()
            filters = {}
            for kwarg, v in kwargs.items():
                if v and kwarg not in [&#34;self&#34;, &#34;start_date&#34;, &#34;end_date&#34;, &#34;url&#34;]:
                    filters.update({kwarg: v})

        response = requests.post(url=url, json={&#34;filters&#34;: filters})
        LOGGER.debug(f&#34;Status code: {response.status_code}&#34;)
        return response

    def bulk_download_status(self, file_name):
        &#34;&#34;&#34;This method returns the current status of a download job
         that has been requested with the v2/bulk_download/awards/
         or v2/bulk_download/transaction/ endpoint that same day.
         [Full documentation for endpoint](https://github.com/fedspendingtransparency/usaspending-api/blob/master/usaspending_api/api_contracts/contracts/v2/download/status.md).

        Parameters
        ----------
        file_name : str
            File name returned in a bulk_download response object
        &#34;&#34;&#34;
        url = self.BASE_URL + f&#34;/api/v2/download/status/?file_name={file_name}&#34;
        response = requests.get(url)
        LOGGER.debug(f&#34;Status code: {response.status_code}&#34;)
        return response

    @LD
    def bulk_awards(
        self,
        start_date=None,
        end_date=None,
        date_type=&#34;action_date&#34;,
        agencies=[{&#34;toptier_name&#34;: &#34;Department of Energy&#34;}],
        prime_award_types=[],
        place_of_performance_locations=[],
        place_of_performance_scope=None,
        recipient_locations=None,
        recipient_scope=None,
        sub_award_types=None,
        filters=None,
        return_df=True,
        file_destination=None,
        attempts=10,
    ):

        &#34;&#34;&#34;This method sends a request to the backend to begin generating a
            zipfile of award data in CSV form for download.  [Full documentation for endpoint](https://github.com/fedspendingtransparency/usaspending-api/blob/master/usaspending_api/api_contracts/contracts/v2/bulk_download/awards.md).

        Parameters
        ----------
        start_date : str
            Required start date of time period.
        end_date : str
            Required end date of time period.
        date_type : enum[str]
            - `&#39;domestic&#39;`
            - `&#39;foreign&#39;`
        agencies : array[Agency]


        prime_award_types : array[enum[string]]

            - `&#39;IDV_A&#39;`
            - `&#39;IDV_B&#39;`
            - `&#39;IDV_B_A&#39;`
            - `&#39;IDV_B_B&#39;`
            - `&#39;IDV_B_C&#39;`
            - `&#39;IDV_C&#39;`
            - `&#39;IDV_D&#39;`
            - `&#39;IDV_E&#39;`
            - `&#39;02&#39;`
            - `&#39;03&#39;`
            - `&#39;04&#39;`
            - `&#39;05&#39;`
            - `&#39;06&#39;`
            - `&#39;07&#39;`
            - `&#39;08&#39;`
            - `&#39;09&#39;`
            - `&#39;10&#39;`
            - `&#39;11&#39;`
            - `&#39;A&#39;`
            - `&#39;B&#39;`
            - `&#39;C&#39;`
            - `&#39;D&#39;`

        place_of_performance_locations : array[Location]

        place_of_performance_scope : enum[string]

            - `&#39;domestic&#39;`
            - `&#39;foreign&#39;`



        recipient_locations : array[Location]

        recipient_scope : enum[string]

            - `&#39;domestic&#39;`
            - `&#39;foreign&#39;`


        sub_award_types : array[enum[string]]

            - `&#39;grant`&#39;
            - `&#39;procurement&#39;`

        filters : object
            A fully built python dictionary with all filters, bypassing all other arguments.
            See [endpoint documentation](https://github.com/fedspendingtransparency/usaspending-api/blob/master/usaspending_api/api_contracts/contracts/v2/bulk_download/awards.md) for an example.

        return_df: bool
            Return a pandas dataframe

        file_destination: str
            If not a pandas dataframe, filelocation to store zipped csv&#39;s

        attempts: int
            Number of times to check if bulk download has completed.

        ## Agency: object

        - name: str
        - tier: enum[str]

            -- `&#39;toptier&#39;`

            -- `&#39;subtier&#39;`

        - type: enum[str]

            -- `&#39;funding&#39;`

            -- `&#39;awarding`&#39;

        ## Location: object

        - `&#39;country`&#39;: str
        - `&#39;state`&#39;: str
        - `&#39;county`&#39;: str
        - `&#39;city`&#39;: str
        - `&#39;district`&#39;: str
        - `&#39;zip`&#39;: str

        Returns
        -------
        pd.DataFrame or zip file
             Final response from the USASpending /api/v2/bulk_download/awards/ endpoint.

        Examples
        -------

        ```python
        &gt;&gt;&gt; #using arguments
        &gt;&gt;&gt; from usaspending_client import USASpending
        &gt;&gt;&gt; usa = USASpending()
        &gt;&gt;&gt; df = usa.awards(start_date=&#34;2019-10-01&#34;, end_date=&#34;2020-09-30&#34;, prime_award_types=[&#34;A&#34;])
        &gt;&gt;&gt; #using filters object
        &gt;&gt;&gt; filters = {&#34;prime_award_types&#34;: [&#34;A&#34;],&#34;sub_award_types&#34;: [],&#34;date_type&#34;: &#34;action_date&#34;,&#34;date_range&#34;: {&#34;start_date&#34;: &#34;2019-10-01&#34;,&#34;end_date&#34;: &#34;2020-09-30&#34;},&#34;agencies&#34;: [{&#34;type&#34;: &#34;funding&#34;,&#34;tier&#34;: &#34;subtier&#34;,&#34;name&#34;: &#34;Animal and Plant Health Inspection Service&#34;,&#34;toptier_name&#34;: &#34;Department of Agriculture&#34;}]}
        &gt;&gt;&gt; df = usa.awards(filters=filters)
        ```
        &#34;&#34;&#34;

        if not return_df and not file_destination:
            msg = &#34;Need to return a pandas dataframe or provide file location for download&#34;
            raise ValueError(msg)

        rqst = self.bulk_download_awards(
            start_date=start_date,
            end_date=end_date,
            date_type=date_type,
            agencies=agencies,
            prime_award_types=prime_award_types,
            place_of_performance_locations=place_of_performance_locations,
            place_of_performance_scope=place_of_performance_scope,
            recipient_locations=recipient_locations,
            recipient_scope=recipient_scope,
            sub_award_types=sub_award_types,
            filters=filters,
        )

        data = json.loads(rqst.text)
        file_name = data[&#34;file_name&#34;]
        status = None
        runs = 0
        while status != &#34;finished&#34; and runs &lt; attempts:
            dl_status = self.bulk_download_status(file_name=file_name)
            data = json.loads(dl_status.text)
            status = data[&#34;status&#34;]
            runs += 1

        try:
            file_url = data[&#34;file_url&#34;]
        except KeyError:
            raise KeyError(f&#34;Bulk download did not finish in {attempts} attempts.&#34;)

        if return_df:

            try:

                # ref: https://stackoverflow.com/a/39217788/4296857
                # ref: https://stackoverflow.com/a/46676405/4296857

                with requests.get(file_url, stream=True) as r:
                    zf = ZipFile(BytesIO(r.content))
                match = [s for s in zf.namelist() if &#34;.csv&#34; in s][0]
                df = pd.read_csv(zf.open(match), low_memory=False)
                return df

            except:
                LOGGER.error(&#34;Failed to return dataframe&#34;, exc_info=True)

        urlretrieve(file_url, file_destination)

    def awards(self, award_id):
        url = self.BASE_URL + f&#34;/api/v2/awards/{award_id}&#34;
        response = requests.get(url)
        LOGGER.debug(f&#34;Status code: {response.status_code}&#34;)
        return response</code></pre>
</details>
</section>
<section>
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-classes">Classes</h2>
<dl>
<dt id="usaspending_client.client.USASpending"><code class="flex name class">
<span>class <span class="ident">USASpending</span></span>
<span>(</span><span>verbosity=10)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class USASpending:
    def __init__(self, verbosity=10):
        self.BASE_URL = &#34;https://api.usaspending.gov&#34;
        logging.basicConfig(stream=sys.stderr, level=verbosity, format=FORMAT)

    @LD
    def bulk_download_awards(
        self,
        start_date=None,
        end_date=None,
        date_type=&#34;action_date&#34;,
        agencies=[{&#34;toptier_name&#34;: &#34;Department of Energy&#34;}],
        prime_award_types=[],
        place_of_performance_locations=[],
        place_of_performance_scope=None,
        recipient_locations=None,
        recipient_scope=None,
        sub_award_types=None,
        filters=None,
    ):
        &#34;&#34;&#34;This method sends a request to the backend to begin generating a
            zipfile of award data in CSV form for download.  [Full documentation for endpoint](https://github.com/fedspendingtransparency/usaspending-api/blob/master/usaspending_api/api_contracts/contracts/v2/bulk_download/awards.md).

        Parameters
        ----------
        start_date : str
            Required start date of time period.
        end_date : str
            Required end date of time period.
        date_type : enum[str]
            - `&#39;domestic&#39;`
            - `&#39;foreign&#39;`
        agencies : array[Agency]


        prime_award_types : array[enum[string]]

            - `&#39;IDV_A&#39;`
            - `&#39;IDV_B&#39;`
            - `&#39;IDV_B_A&#39;`
            - `&#39;IDV_B_B&#39;`
            - `&#39;IDV_B_C&#39;`
            - `&#39;IDV_C&#39;`
            - `&#39;IDV_D&#39;`
            - `&#39;IDV_E&#39;`
            - `&#39;02&#39;`
            - `&#39;03&#39;`
            - `&#39;04&#39;`
            - `&#39;05&#39;`
            - `&#39;06&#39;`
            - `&#39;07&#39;`
            - `&#39;08&#39;`
            - `&#39;09&#39;`
            - `&#39;10&#39;`
            - `&#39;11&#39;`
            - `&#39;A&#39;`
            - `&#39;B&#39;`
            - `&#39;C&#39;`
            - `&#39;D&#39;`

        place_of_performance_locations : array[Location]

        place_of_performance_scope : enum[string]

            - `&#39;domestic&#39;`
            - `&#39;foreign&#39;`



        recipient_locations : array[Location]

        recipient_scope : enum[string]

            - `&#39;domestic&#39;`
            - `&#39;foreign&#39;`


        sub_award_types : array[enum[string]]

            - `&#39;grant`&#39;
            - `&#39;procurement&#39;`

        filters : object
            A fully built python dictionary with all filters, bypassing all other arguments.
            See [endpoint documentation](https://github.com/fedspendingtransparency/usaspending-api/blob/master/usaspending_api/api_contracts/contracts/v2/bulk_download/awards.md) for an example.


        ## Agency: object

        - name: str
        - tier: enum[str]

            -- `&#39;toptier&#39;`

            -- `&#39;subtier&#39;`

        - type: enum[str]

            -- `&#39;funding&#39;`

            -- `&#39;awarding`&#39;

        ## Location: object

        - `&#39;country`&#39;: str
        - `&#39;state`&#39;: str
        - `&#39;county`&#39;: str
        - `&#39;city`&#39;: str
        - `&#39;district`&#39;: str
        - `&#39;zip`&#39;: str

        Returns
        -------
        request.response
            Response from the USASpending /api/v2/bulk_download/awards/ endpoint.

        Examples
        -------

        ```python
        &gt;&gt;&gt; #using arguments
        &gt;&gt;&gt; from usaspending_client import USASpending
        &gt;&gt;&gt; usa = USASpending()
        &gt;&gt;&gt; response = usa.bulk_download_awards(start_date=&#34;2019-10-01&#34;, end_date=&#34;2020-09-30&#34;, prime_award_types=[&#34;A&#34;])
        &gt;&gt;&gt; #using filters object
        &gt;&gt;&gt; filters = {&#34;prime_award_types&#34;: [&#34;A&#34;],&#34;sub_award_types&#34;: [],&#34;date_type&#34;: &#34;action_date&#34;,&#34;date_range&#34;: {&#34;start_date&#34;: &#34;2019-10-01&#34;,&#34;end_date&#34;: &#34;2020-09-30&#34;},&#34;agencies&#34;: [{&#34;type&#34;: &#34;funding&#34;,&#34;tier&#34;: &#34;subtier&#34;,&#34;name&#34;: &#34;Animal and Plant Health Inspection Service&#34;,&#34;toptier_name&#34;: &#34;Department of Agriculture&#34;}]}
        &gt;&gt;&gt; response = usa.bulk_download_awards(filters=filters)
        ```
        &#34;&#34;&#34;
        url = self.BASE_URL + &#34;/api/v2/bulk_download/awards/&#34;

        if not filters:
            start_date = pd.to_datetime(start_date).strftime(&#34;%Y-%m-%d&#34;)
            end_date = pd.to_datetime(end_date).strftime(&#34;%Y-%m-%d&#34;)
            date_range = {&#34;start_date&#34;: start_date, &#34;end_date&#34;: end_date}
            kwargs = locals()
            filters = {}
            for kwarg, v in kwargs.items():
                if v and kwarg not in [&#34;self&#34;, &#34;start_date&#34;, &#34;end_date&#34;, &#34;url&#34;]:
                    filters.update({kwarg: v})

        response = requests.post(url=url, json={&#34;filters&#34;: filters})
        LOGGER.debug(f&#34;Status code: {response.status_code}&#34;)
        return response

    def bulk_download_status(self, file_name):
        &#34;&#34;&#34;This method returns the current status of a download job
         that has been requested with the v2/bulk_download/awards/
         or v2/bulk_download/transaction/ endpoint that same day.
         [Full documentation for endpoint](https://github.com/fedspendingtransparency/usaspending-api/blob/master/usaspending_api/api_contracts/contracts/v2/download/status.md).

        Parameters
        ----------
        file_name : str
            File name returned in a bulk_download response object
        &#34;&#34;&#34;
        url = self.BASE_URL + f&#34;/api/v2/download/status/?file_name={file_name}&#34;
        response = requests.get(url)
        LOGGER.debug(f&#34;Status code: {response.status_code}&#34;)
        return response

    @LD
    def bulk_awards(
        self,
        start_date=None,
        end_date=None,
        date_type=&#34;action_date&#34;,
        agencies=[{&#34;toptier_name&#34;: &#34;Department of Energy&#34;}],
        prime_award_types=[],
        place_of_performance_locations=[],
        place_of_performance_scope=None,
        recipient_locations=None,
        recipient_scope=None,
        sub_award_types=None,
        filters=None,
        return_df=True,
        file_destination=None,
        attempts=10,
    ):

        &#34;&#34;&#34;This method sends a request to the backend to begin generating a
            zipfile of award data in CSV form for download.  [Full documentation for endpoint](https://github.com/fedspendingtransparency/usaspending-api/blob/master/usaspending_api/api_contracts/contracts/v2/bulk_download/awards.md).

        Parameters
        ----------
        start_date : str
            Required start date of time period.
        end_date : str
            Required end date of time period.
        date_type : enum[str]
            - `&#39;domestic&#39;`
            - `&#39;foreign&#39;`
        agencies : array[Agency]


        prime_award_types : array[enum[string]]

            - `&#39;IDV_A&#39;`
            - `&#39;IDV_B&#39;`
            - `&#39;IDV_B_A&#39;`
            - `&#39;IDV_B_B&#39;`
            - `&#39;IDV_B_C&#39;`
            - `&#39;IDV_C&#39;`
            - `&#39;IDV_D&#39;`
            - `&#39;IDV_E&#39;`
            - `&#39;02&#39;`
            - `&#39;03&#39;`
            - `&#39;04&#39;`
            - `&#39;05&#39;`
            - `&#39;06&#39;`
            - `&#39;07&#39;`
            - `&#39;08&#39;`
            - `&#39;09&#39;`
            - `&#39;10&#39;`
            - `&#39;11&#39;`
            - `&#39;A&#39;`
            - `&#39;B&#39;`
            - `&#39;C&#39;`
            - `&#39;D&#39;`

        place_of_performance_locations : array[Location]

        place_of_performance_scope : enum[string]

            - `&#39;domestic&#39;`
            - `&#39;foreign&#39;`



        recipient_locations : array[Location]

        recipient_scope : enum[string]

            - `&#39;domestic&#39;`
            - `&#39;foreign&#39;`


        sub_award_types : array[enum[string]]

            - `&#39;grant`&#39;
            - `&#39;procurement&#39;`

        filters : object
            A fully built python dictionary with all filters, bypassing all other arguments.
            See [endpoint documentation](https://github.com/fedspendingtransparency/usaspending-api/blob/master/usaspending_api/api_contracts/contracts/v2/bulk_download/awards.md) for an example.

        return_df: bool
            Return a pandas dataframe

        file_destination: str
            If not a pandas dataframe, filelocation to store zipped csv&#39;s

        attempts: int
            Number of times to check if bulk download has completed.

        ## Agency: object

        - name: str
        - tier: enum[str]

            -- `&#39;toptier&#39;`

            -- `&#39;subtier&#39;`

        - type: enum[str]

            -- `&#39;funding&#39;`

            -- `&#39;awarding`&#39;

        ## Location: object

        - `&#39;country`&#39;: str
        - `&#39;state`&#39;: str
        - `&#39;county`&#39;: str
        - `&#39;city`&#39;: str
        - `&#39;district`&#39;: str
        - `&#39;zip`&#39;: str

        Returns
        -------
        pd.DataFrame or zip file
             Final response from the USASpending /api/v2/bulk_download/awards/ endpoint.

        Examples
        -------

        ```python
        &gt;&gt;&gt; #using arguments
        &gt;&gt;&gt; from usaspending_client import USASpending
        &gt;&gt;&gt; usa = USASpending()
        &gt;&gt;&gt; df = usa.awards(start_date=&#34;2019-10-01&#34;, end_date=&#34;2020-09-30&#34;, prime_award_types=[&#34;A&#34;])
        &gt;&gt;&gt; #using filters object
        &gt;&gt;&gt; filters = {&#34;prime_award_types&#34;: [&#34;A&#34;],&#34;sub_award_types&#34;: [],&#34;date_type&#34;: &#34;action_date&#34;,&#34;date_range&#34;: {&#34;start_date&#34;: &#34;2019-10-01&#34;,&#34;end_date&#34;: &#34;2020-09-30&#34;},&#34;agencies&#34;: [{&#34;type&#34;: &#34;funding&#34;,&#34;tier&#34;: &#34;subtier&#34;,&#34;name&#34;: &#34;Animal and Plant Health Inspection Service&#34;,&#34;toptier_name&#34;: &#34;Department of Agriculture&#34;}]}
        &gt;&gt;&gt; df = usa.awards(filters=filters)
        ```
        &#34;&#34;&#34;

        if not return_df and not file_destination:
            msg = &#34;Need to return a pandas dataframe or provide file location for download&#34;
            raise ValueError(msg)

        rqst = self.bulk_download_awards(
            start_date=start_date,
            end_date=end_date,
            date_type=date_type,
            agencies=agencies,
            prime_award_types=prime_award_types,
            place_of_performance_locations=place_of_performance_locations,
            place_of_performance_scope=place_of_performance_scope,
            recipient_locations=recipient_locations,
            recipient_scope=recipient_scope,
            sub_award_types=sub_award_types,
            filters=filters,
        )

        data = json.loads(rqst.text)
        file_name = data[&#34;file_name&#34;]
        status = None
        runs = 0
        while status != &#34;finished&#34; and runs &lt; attempts:
            dl_status = self.bulk_download_status(file_name=file_name)
            data = json.loads(dl_status.text)
            status = data[&#34;status&#34;]
            runs += 1

        try:
            file_url = data[&#34;file_url&#34;]
        except KeyError:
            raise KeyError(f&#34;Bulk download did not finish in {attempts} attempts.&#34;)

        if return_df:

            try:

                # ref: https://stackoverflow.com/a/39217788/4296857
                # ref: https://stackoverflow.com/a/46676405/4296857

                with requests.get(file_url, stream=True) as r:
                    zf = ZipFile(BytesIO(r.content))
                match = [s for s in zf.namelist() if &#34;.csv&#34; in s][0]
                df = pd.read_csv(zf.open(match), low_memory=False)
                return df

            except:
                LOGGER.error(&#34;Failed to return dataframe&#34;, exc_info=True)

        urlretrieve(file_url, file_destination)

    def awards(self, award_id):
        url = self.BASE_URL + f&#34;/api/v2/awards/{award_id}&#34;
        response = requests.get(url)
        LOGGER.debug(f&#34;Status code: {response.status_code}&#34;)
        return response</code></pre>
</details>
<h3>Methods</h3>
<dl>
<dt id="usaspending_client.client.USASpending.awards"><code class="name flex">
<span>def <span class="ident">awards</span></span>(<span>self, award_id)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def awards(self, award_id):
    url = self.BASE_URL + f&#34;/api/v2/awards/{award_id}&#34;
    response = requests.get(url)
    LOGGER.debug(f&#34;Status code: {response.status_code}&#34;)
    return response</code></pre>
</details>
</dd>
<dt id="usaspending_client.client.USASpending.bulk_awards"><code class="name flex">
<span>def <span class="ident">bulk_awards</span></span>(<span>self, start_date=None, end_date=None, date_type='action_date', agencies=[{'toptier_name': 'Department of Energy'}], prime_award_types=[], place_of_performance_locations=[], place_of_performance_scope=None, recipient_locations=None, recipient_scope=None, sub_award_types=None, filters=None, return_df=True, file_destination=None, attempts=10)</span>
</code></dt>
<dd>
<div class="desc"><p>This method sends a request to the backend to begin generating a
zipfile of award data in CSV form for download.
<a href="https://github.com/fedspendingtransparency/usaspending-api/blob/master/usaspending_api/api_contracts/contracts/v2/bulk_download/awards.md">Full documentation for endpoint</a>.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>start_date</code></strong> :&ensp;<code>str</code></dt>
<dd>Required start date of time period.</dd>
<dt><strong><code>end_date</code></strong> :&ensp;<code>str</code></dt>
<dd>Required end date of time period.</dd>
<dt><strong><code>date_type</code></strong> :&ensp;<code>enum[str]</code></dt>
<dd>
<ul>
<li><code>'domestic'</code></li>
<li><code>'foreign'</code></li>
</ul>
</dd>
<dt><strong><code>agencies</code></strong> :&ensp;<code>array[Agency]</code></dt>
<dd>&nbsp;</dd>
<dt><strong><code>prime_award_types</code></strong> :&ensp;<code>array[enum[string]]</code></dt>
<dd>
<ul>
<li><code>'IDV_A'</code></li>
<li><code>'IDV_B'</code></li>
<li><code>'IDV_B_A'</code></li>
<li><code>'IDV_B_B'</code></li>
<li><code>'IDV_B_C'</code></li>
<li><code>'IDV_C'</code></li>
<li><code>'IDV_D'</code></li>
<li><code>'IDV_E'</code></li>
<li><code>'02'</code></li>
<li><code>'03'</code></li>
<li><code>'04'</code></li>
<li><code>'05'</code></li>
<li><code>'06'</code></li>
<li><code>'07'</code></li>
<li><code>'08'</code></li>
<li><code>'09'</code></li>
<li><code>'10'</code></li>
<li><code>'11'</code></li>
<li><code>'A'</code></li>
<li><code>'B'</code></li>
<li><code>'C'</code></li>
<li><code>'D'</code></li>
</ul>
</dd>
<dt><strong><code>place_of_performance_locations</code></strong> :&ensp;<code>array[Location]</code></dt>
<dd>&nbsp;</dd>
<dt><strong><code>place_of_performance_scope</code></strong> :&ensp;<code>enum[string]</code></dt>
<dd>
<ul>
<li><code>'domestic'</code></li>
<li><code>'foreign'</code></li>
</ul>
</dd>
<dt><strong><code>recipient_locations</code></strong> :&ensp;<code>array[Location]</code></dt>
<dd>&nbsp;</dd>
<dt><strong><code>recipient_scope</code></strong> :&ensp;<code>enum[string]</code></dt>
<dd>
<ul>
<li><code>'domestic'</code></li>
<li><code>'foreign'</code></li>
</ul>
</dd>
<dt><strong><code>sub_award_types</code></strong> :&ensp;<code>array[enum[string]]</code></dt>
<dd>
<ul>
<li><code>'grant</code>'</li>
<li><code>'procurement'</code></li>
</ul>
</dd>
<dt><strong><code>filters</code></strong> :&ensp;<code>object</code></dt>
<dd>A fully built python dictionary with all filters, bypassing all other arguments.
See <a href="https://github.com/fedspendingtransparency/usaspending-api/blob/master/usaspending_api/api_contracts/contracts/v2/bulk_download/awards.md">endpoint documentation</a> for an example.</dd>
<dt><strong><code>return_df</code></strong> :&ensp;<code>bool</code></dt>
<dd>Return a pandas dataframe</dd>
<dt><strong><code>file_destination</code></strong> :&ensp;<code>str</code></dt>
<dd>If not a pandas dataframe, filelocation to store zipped csv's</dd>
<dt><strong><code>attempts</code></strong> :&ensp;<code>int</code></dt>
<dd>Number of times to check if bulk download has completed.</dd>
</dl>
<h2 id="agency-object">Agency: object</h2>
<ul>
<li>name: str</li>
<li>
<p>tier: enum[str]</p>
<p>&ndash; <code>'toptier'</code></p>
<p>&ndash; <code>'subtier'</code></p>
</li>
<li>
<p>type: enum[str]</p>
<p>&ndash; <code>'funding'</code></p>
<p>&ndash; <code>'awarding</code>'</p>
</li>
</ul>
<h2 id="location-object">Location: object</h2>
<ul>
<li><code>'country</code>': str</li>
<li><code>'state</code>': str</li>
<li><code>'county</code>': str</li>
<li><code>'city</code>': str</li>
<li><code>'district</code>': str</li>
<li><code>'zip</code>': str</li>
</ul>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>pd.DataFrame</code> or <code>zip file</code></dt>
<dd>Final response from the USASpending /api/v2/bulk_download/awards/ endpoint.</dd>
</dl>
<h2 id="examples">Examples</h2>
<pre><code class="language-python">&gt;&gt;&gt; #using arguments
&gt;&gt;&gt; from usaspending_client import USASpending
&gt;&gt;&gt; usa = USASpending()
&gt;&gt;&gt; df = usa.awards(start_date=&quot;2019-10-01&quot;, end_date=&quot;2020-09-30&quot;, prime_award_types=[&quot;A&quot;])
&gt;&gt;&gt; #using filters object
&gt;&gt;&gt; filters = {&quot;prime_award_types&quot;: [&quot;A&quot;],&quot;sub_award_types&quot;: [],&quot;date_type&quot;: &quot;action_date&quot;,&quot;date_range&quot;: {&quot;start_date&quot;: &quot;2019-10-01&quot;,&quot;end_date&quot;: &quot;2020-09-30&quot;},&quot;agencies&quot;: [{&quot;type&quot;: &quot;funding&quot;,&quot;tier&quot;: &quot;subtier&quot;,&quot;name&quot;: &quot;Animal and Plant Health Inspection Service&quot;,&quot;toptier_name&quot;: &quot;Department of Agriculture&quot;}]}
&gt;&gt;&gt; df = usa.awards(filters=filters)
</code></pre></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@LD
def bulk_awards(
    self,
    start_date=None,
    end_date=None,
    date_type=&#34;action_date&#34;,
    agencies=[{&#34;toptier_name&#34;: &#34;Department of Energy&#34;}],
    prime_award_types=[],
    place_of_performance_locations=[],
    place_of_performance_scope=None,
    recipient_locations=None,
    recipient_scope=None,
    sub_award_types=None,
    filters=None,
    return_df=True,
    file_destination=None,
    attempts=10,
):

    &#34;&#34;&#34;This method sends a request to the backend to begin generating a
        zipfile of award data in CSV form for download.  [Full documentation for endpoint](https://github.com/fedspendingtransparency/usaspending-api/blob/master/usaspending_api/api_contracts/contracts/v2/bulk_download/awards.md).

    Parameters
    ----------
    start_date : str
        Required start date of time period.
    end_date : str
        Required end date of time period.
    date_type : enum[str]
        - `&#39;domestic&#39;`
        - `&#39;foreign&#39;`
    agencies : array[Agency]


    prime_award_types : array[enum[string]]

        - `&#39;IDV_A&#39;`
        - `&#39;IDV_B&#39;`
        - `&#39;IDV_B_A&#39;`
        - `&#39;IDV_B_B&#39;`
        - `&#39;IDV_B_C&#39;`
        - `&#39;IDV_C&#39;`
        - `&#39;IDV_D&#39;`
        - `&#39;IDV_E&#39;`
        - `&#39;02&#39;`
        - `&#39;03&#39;`
        - `&#39;04&#39;`
        - `&#39;05&#39;`
        - `&#39;06&#39;`
        - `&#39;07&#39;`
        - `&#39;08&#39;`
        - `&#39;09&#39;`
        - `&#39;10&#39;`
        - `&#39;11&#39;`
        - `&#39;A&#39;`
        - `&#39;B&#39;`
        - `&#39;C&#39;`
        - `&#39;D&#39;`

    place_of_performance_locations : array[Location]

    place_of_performance_scope : enum[string]

        - `&#39;domestic&#39;`
        - `&#39;foreign&#39;`



    recipient_locations : array[Location]

    recipient_scope : enum[string]

        - `&#39;domestic&#39;`
        - `&#39;foreign&#39;`


    sub_award_types : array[enum[string]]

        - `&#39;grant`&#39;
        - `&#39;procurement&#39;`

    filters : object
        A fully built python dictionary with all filters, bypassing all other arguments.
        See [endpoint documentation](https://github.com/fedspendingtransparency/usaspending-api/blob/master/usaspending_api/api_contracts/contracts/v2/bulk_download/awards.md) for an example.

    return_df: bool
        Return a pandas dataframe

    file_destination: str
        If not a pandas dataframe, filelocation to store zipped csv&#39;s

    attempts: int
        Number of times to check if bulk download has completed.

    ## Agency: object

    - name: str
    - tier: enum[str]

        -- `&#39;toptier&#39;`

        -- `&#39;subtier&#39;`

    - type: enum[str]

        -- `&#39;funding&#39;`

        -- `&#39;awarding`&#39;

    ## Location: object

    - `&#39;country`&#39;: str
    - `&#39;state`&#39;: str
    - `&#39;county`&#39;: str
    - `&#39;city`&#39;: str
    - `&#39;district`&#39;: str
    - `&#39;zip`&#39;: str

    Returns
    -------
    pd.DataFrame or zip file
         Final response from the USASpending /api/v2/bulk_download/awards/ endpoint.

    Examples
    -------

    ```python
    &gt;&gt;&gt; #using arguments
    &gt;&gt;&gt; from usaspending_client import USASpending
    &gt;&gt;&gt; usa = USASpending()
    &gt;&gt;&gt; df = usa.awards(start_date=&#34;2019-10-01&#34;, end_date=&#34;2020-09-30&#34;, prime_award_types=[&#34;A&#34;])
    &gt;&gt;&gt; #using filters object
    &gt;&gt;&gt; filters = {&#34;prime_award_types&#34;: [&#34;A&#34;],&#34;sub_award_types&#34;: [],&#34;date_type&#34;: &#34;action_date&#34;,&#34;date_range&#34;: {&#34;start_date&#34;: &#34;2019-10-01&#34;,&#34;end_date&#34;: &#34;2020-09-30&#34;},&#34;agencies&#34;: [{&#34;type&#34;: &#34;funding&#34;,&#34;tier&#34;: &#34;subtier&#34;,&#34;name&#34;: &#34;Animal and Plant Health Inspection Service&#34;,&#34;toptier_name&#34;: &#34;Department of Agriculture&#34;}]}
    &gt;&gt;&gt; df = usa.awards(filters=filters)
    ```
    &#34;&#34;&#34;

    if not return_df and not file_destination:
        msg = &#34;Need to return a pandas dataframe or provide file location for download&#34;
        raise ValueError(msg)

    rqst = self.bulk_download_awards(
        start_date=start_date,
        end_date=end_date,
        date_type=date_type,
        agencies=agencies,
        prime_award_types=prime_award_types,
        place_of_performance_locations=place_of_performance_locations,
        place_of_performance_scope=place_of_performance_scope,
        recipient_locations=recipient_locations,
        recipient_scope=recipient_scope,
        sub_award_types=sub_award_types,
        filters=filters,
    )

    data = json.loads(rqst.text)
    file_name = data[&#34;file_name&#34;]
    status = None
    runs = 0
    while status != &#34;finished&#34; and runs &lt; attempts:
        dl_status = self.bulk_download_status(file_name=file_name)
        data = json.loads(dl_status.text)
        status = data[&#34;status&#34;]
        runs += 1

    try:
        file_url = data[&#34;file_url&#34;]
    except KeyError:
        raise KeyError(f&#34;Bulk download did not finish in {attempts} attempts.&#34;)

    if return_df:

        try:

            # ref: https://stackoverflow.com/a/39217788/4296857
            # ref: https://stackoverflow.com/a/46676405/4296857

            with requests.get(file_url, stream=True) as r:
                zf = ZipFile(BytesIO(r.content))
            match = [s for s in zf.namelist() if &#34;.csv&#34; in s][0]
            df = pd.read_csv(zf.open(match), low_memory=False)
            return df

        except:
            LOGGER.error(&#34;Failed to return dataframe&#34;, exc_info=True)

    urlretrieve(file_url, file_destination)</code></pre>
</details>
</dd>
<dt id="usaspending_client.client.USASpending.bulk_download_awards"><code class="name flex">
<span>def <span class="ident">bulk_download_awards</span></span>(<span>self, start_date=None, end_date=None, date_type='action_date', agencies=[{'toptier_name': 'Department of Energy'}], prime_award_types=[], place_of_performance_locations=[], place_of_performance_scope=None, recipient_locations=None, recipient_scope=None, sub_award_types=None, filters=None)</span>
</code></dt>
<dd>
<div class="desc"><p>This method sends a request to the backend to begin generating a
zipfile of award data in CSV form for download.
<a href="https://github.com/fedspendingtransparency/usaspending-api/blob/master/usaspending_api/api_contracts/contracts/v2/bulk_download/awards.md">Full documentation for endpoint</a>.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>start_date</code></strong> :&ensp;<code>str</code></dt>
<dd>Required start date of time period.</dd>
<dt><strong><code>end_date</code></strong> :&ensp;<code>str</code></dt>
<dd>Required end date of time period.</dd>
<dt><strong><code>date_type</code></strong> :&ensp;<code>enum[str]</code></dt>
<dd>
<ul>
<li><code>'domestic'</code></li>
<li><code>'foreign'</code></li>
</ul>
</dd>
<dt><strong><code>agencies</code></strong> :&ensp;<code>array[Agency]</code></dt>
<dd>&nbsp;</dd>
<dt><strong><code>prime_award_types</code></strong> :&ensp;<code>array[enum[string]]</code></dt>
<dd>
<ul>
<li><code>'IDV_A'</code></li>
<li><code>'IDV_B'</code></li>
<li><code>'IDV_B_A'</code></li>
<li><code>'IDV_B_B'</code></li>
<li><code>'IDV_B_C'</code></li>
<li><code>'IDV_C'</code></li>
<li><code>'IDV_D'</code></li>
<li><code>'IDV_E'</code></li>
<li><code>'02'</code></li>
<li><code>'03'</code></li>
<li><code>'04'</code></li>
<li><code>'05'</code></li>
<li><code>'06'</code></li>
<li><code>'07'</code></li>
<li><code>'08'</code></li>
<li><code>'09'</code></li>
<li><code>'10'</code></li>
<li><code>'11'</code></li>
<li><code>'A'</code></li>
<li><code>'B'</code></li>
<li><code>'C'</code></li>
<li><code>'D'</code></li>
</ul>
</dd>
<dt><strong><code>place_of_performance_locations</code></strong> :&ensp;<code>array[Location]</code></dt>
<dd>&nbsp;</dd>
<dt><strong><code>place_of_performance_scope</code></strong> :&ensp;<code>enum[string]</code></dt>
<dd>
<ul>
<li><code>'domestic'</code></li>
<li><code>'foreign'</code></li>
</ul>
</dd>
<dt><strong><code>recipient_locations</code></strong> :&ensp;<code>array[Location]</code></dt>
<dd>&nbsp;</dd>
<dt><strong><code>recipient_scope</code></strong> :&ensp;<code>enum[string]</code></dt>
<dd>
<ul>
<li><code>'domestic'</code></li>
<li><code>'foreign'</code></li>
</ul>
</dd>
<dt><strong><code>sub_award_types</code></strong> :&ensp;<code>array[enum[string]]</code></dt>
<dd>
<ul>
<li><code>'grant</code>'</li>
<li><code>'procurement'</code></li>
</ul>
</dd>
<dt><strong><code>filters</code></strong> :&ensp;<code>object</code></dt>
<dd>A fully built python dictionary with all filters, bypassing all other arguments.
See <a href="https://github.com/fedspendingtransparency/usaspending-api/blob/master/usaspending_api/api_contracts/contracts/v2/bulk_download/awards.md">endpoint documentation</a> for an example.</dd>
</dl>
<h2 id="agency-object">Agency: object</h2>
<ul>
<li>name: str</li>
<li>
<p>tier: enum[str]</p>
<p>&ndash; <code>'toptier'</code></p>
<p>&ndash; <code>'subtier'</code></p>
</li>
<li>
<p>type: enum[str]</p>
<p>&ndash; <code>'funding'</code></p>
<p>&ndash; <code>'awarding</code>'</p>
</li>
</ul>
<h2 id="location-object">Location: object</h2>
<ul>
<li><code>'country</code>': str</li>
<li><code>'state</code>': str</li>
<li><code>'county</code>': str</li>
<li><code>'city</code>': str</li>
<li><code>'district</code>': str</li>
<li><code>'zip</code>': str</li>
</ul>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>request.response</code></dt>
<dd>Response from the USASpending /api/v2/bulk_download/awards/ endpoint.</dd>
</dl>
<h2 id="examples">Examples</h2>
<pre><code class="language-python">&gt;&gt;&gt; #using arguments
&gt;&gt;&gt; from usaspending_client import USASpending
&gt;&gt;&gt; usa = USASpending()
&gt;&gt;&gt; response = usa.bulk_download_awards(start_date=&quot;2019-10-01&quot;, end_date=&quot;2020-09-30&quot;, prime_award_types=[&quot;A&quot;])
&gt;&gt;&gt; #using filters object
&gt;&gt;&gt; filters = {&quot;prime_award_types&quot;: [&quot;A&quot;],&quot;sub_award_types&quot;: [],&quot;date_type&quot;: &quot;action_date&quot;,&quot;date_range&quot;: {&quot;start_date&quot;: &quot;2019-10-01&quot;,&quot;end_date&quot;: &quot;2020-09-30&quot;},&quot;agencies&quot;: [{&quot;type&quot;: &quot;funding&quot;,&quot;tier&quot;: &quot;subtier&quot;,&quot;name&quot;: &quot;Animal and Plant Health Inspection Service&quot;,&quot;toptier_name&quot;: &quot;Department of Agriculture&quot;}]}
&gt;&gt;&gt; response = usa.bulk_download_awards(filters=filters)
</code></pre></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@LD
def bulk_download_awards(
    self,
    start_date=None,
    end_date=None,
    date_type=&#34;action_date&#34;,
    agencies=[{&#34;toptier_name&#34;: &#34;Department of Energy&#34;}],
    prime_award_types=[],
    place_of_performance_locations=[],
    place_of_performance_scope=None,
    recipient_locations=None,
    recipient_scope=None,
    sub_award_types=None,
    filters=None,
):
    &#34;&#34;&#34;This method sends a request to the backend to begin generating a
        zipfile of award data in CSV form for download.  [Full documentation for endpoint](https://github.com/fedspendingtransparency/usaspending-api/blob/master/usaspending_api/api_contracts/contracts/v2/bulk_download/awards.md).

    Parameters
    ----------
    start_date : str
        Required start date of time period.
    end_date : str
        Required end date of time period.
    date_type : enum[str]
        - `&#39;domestic&#39;`
        - `&#39;foreign&#39;`
    agencies : array[Agency]


    prime_award_types : array[enum[string]]

        - `&#39;IDV_A&#39;`
        - `&#39;IDV_B&#39;`
        - `&#39;IDV_B_A&#39;`
        - `&#39;IDV_B_B&#39;`
        - `&#39;IDV_B_C&#39;`
        - `&#39;IDV_C&#39;`
        - `&#39;IDV_D&#39;`
        - `&#39;IDV_E&#39;`
        - `&#39;02&#39;`
        - `&#39;03&#39;`
        - `&#39;04&#39;`
        - `&#39;05&#39;`
        - `&#39;06&#39;`
        - `&#39;07&#39;`
        - `&#39;08&#39;`
        - `&#39;09&#39;`
        - `&#39;10&#39;`
        - `&#39;11&#39;`
        - `&#39;A&#39;`
        - `&#39;B&#39;`
        - `&#39;C&#39;`
        - `&#39;D&#39;`

    place_of_performance_locations : array[Location]

    place_of_performance_scope : enum[string]

        - `&#39;domestic&#39;`
        - `&#39;foreign&#39;`



    recipient_locations : array[Location]

    recipient_scope : enum[string]

        - `&#39;domestic&#39;`
        - `&#39;foreign&#39;`


    sub_award_types : array[enum[string]]

        - `&#39;grant`&#39;
        - `&#39;procurement&#39;`

    filters : object
        A fully built python dictionary with all filters, bypassing all other arguments.
        See [endpoint documentation](https://github.com/fedspendingtransparency/usaspending-api/blob/master/usaspending_api/api_contracts/contracts/v2/bulk_download/awards.md) for an example.


    ## Agency: object

    - name: str
    - tier: enum[str]

        -- `&#39;toptier&#39;`

        -- `&#39;subtier&#39;`

    - type: enum[str]

        -- `&#39;funding&#39;`

        -- `&#39;awarding`&#39;

    ## Location: object

    - `&#39;country`&#39;: str
    - `&#39;state`&#39;: str
    - `&#39;county`&#39;: str
    - `&#39;city`&#39;: str
    - `&#39;district`&#39;: str
    - `&#39;zip`&#39;: str

    Returns
    -------
    request.response
        Response from the USASpending /api/v2/bulk_download/awards/ endpoint.

    Examples
    -------

    ```python
    &gt;&gt;&gt; #using arguments
    &gt;&gt;&gt; from usaspending_client import USASpending
    &gt;&gt;&gt; usa = USASpending()
    &gt;&gt;&gt; response = usa.bulk_download_awards(start_date=&#34;2019-10-01&#34;, end_date=&#34;2020-09-30&#34;, prime_award_types=[&#34;A&#34;])
    &gt;&gt;&gt; #using filters object
    &gt;&gt;&gt; filters = {&#34;prime_award_types&#34;: [&#34;A&#34;],&#34;sub_award_types&#34;: [],&#34;date_type&#34;: &#34;action_date&#34;,&#34;date_range&#34;: {&#34;start_date&#34;: &#34;2019-10-01&#34;,&#34;end_date&#34;: &#34;2020-09-30&#34;},&#34;agencies&#34;: [{&#34;type&#34;: &#34;funding&#34;,&#34;tier&#34;: &#34;subtier&#34;,&#34;name&#34;: &#34;Animal and Plant Health Inspection Service&#34;,&#34;toptier_name&#34;: &#34;Department of Agriculture&#34;}]}
    &gt;&gt;&gt; response = usa.bulk_download_awards(filters=filters)
    ```
    &#34;&#34;&#34;
    url = self.BASE_URL + &#34;/api/v2/bulk_download/awards/&#34;

    if not filters:
        start_date = pd.to_datetime(start_date).strftime(&#34;%Y-%m-%d&#34;)
        end_date = pd.to_datetime(end_date).strftime(&#34;%Y-%m-%d&#34;)
        date_range = {&#34;start_date&#34;: start_date, &#34;end_date&#34;: end_date}
        kwargs = locals()
        filters = {}
        for kwarg, v in kwargs.items():
            if v and kwarg not in [&#34;self&#34;, &#34;start_date&#34;, &#34;end_date&#34;, &#34;url&#34;]:
                filters.update({kwarg: v})

    response = requests.post(url=url, json={&#34;filters&#34;: filters})
    LOGGER.debug(f&#34;Status code: {response.status_code}&#34;)
    return response</code></pre>
</details>
</dd>
<dt id="usaspending_client.client.USASpending.bulk_download_status"><code class="name flex">
<span>def <span class="ident">bulk_download_status</span></span>(<span>self, file_name)</span>
</code></dt>
<dd>
<div class="desc"><p>This method returns the current status of a download job
that has been requested with the v2/bulk_download/awards/
or v2/bulk_download/transaction/ endpoint that same day.
<a href="https://github.com/fedspendingtransparency/usaspending-api/blob/master/usaspending_api/api_contracts/contracts/v2/download/status.md">Full documentation for endpoint</a>.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>file_name</code></strong> :&ensp;<code>str</code></dt>
<dd>File name returned in a bulk_download response object</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def bulk_download_status(self, file_name):
    &#34;&#34;&#34;This method returns the current status of a download job
     that has been requested with the v2/bulk_download/awards/
     or v2/bulk_download/transaction/ endpoint that same day.
     [Full documentation for endpoint](https://github.com/fedspendingtransparency/usaspending-api/blob/master/usaspending_api/api_contracts/contracts/v2/download/status.md).

    Parameters
    ----------
    file_name : str
        File name returned in a bulk_download response object
    &#34;&#34;&#34;
    url = self.BASE_URL + f&#34;/api/v2/download/status/?file_name={file_name}&#34;
    response = requests.get(url)
    LOGGER.debug(f&#34;Status code: {response.status_code}&#34;)
    return response</code></pre>
</details>
</dd>
</dl>
</dd>
</dl>
</section>
</article>
<nav id="sidebar">
<h1>Index</h1>
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="usaspending_client" href="index.html">usaspending_client</a></code></li>
</ul>
</li>
<li><h3><a href="#header-classes">Classes</a></h3>
<ul>
<li>
<h4><code><a title="usaspending_client.client.USASpending" href="#usaspending_client.client.USASpending">USASpending</a></code></h4>
<ul class="">
<li><code><a title="usaspending_client.client.USASpending.awards" href="#usaspending_client.client.USASpending.awards">awards</a></code></li>
<li><code><a title="usaspending_client.client.USASpending.bulk_awards" href="#usaspending_client.client.USASpending.bulk_awards">bulk_awards</a></code></li>
<li><code><a title="usaspending_client.client.USASpending.bulk_download_awards" href="#usaspending_client.client.USASpending.bulk_download_awards">bulk_download_awards</a></code></li>
<li><code><a title="usaspending_client.client.USASpending.bulk_download_status" href="#usaspending_client.client.USASpending.bulk_download_status">bulk_download_status</a></code></li>
</ul>
</li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc"><cite>pdoc</cite> 0.9.2</a>.</p>
</footer>
</body>
</html>